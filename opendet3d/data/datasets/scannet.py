"""ScanNet dataset."""

from __future__ import annotations

from vis4d.common.typing import ArgsType, DictStrAny

from .coco3d import COCO3DDataset

scannet_class_map = {
    "cabinet": 3,
    "bed": 4,
    "chair": 5,
    "sofa": 6,
    "table": 7,
    "door": 8,
    "window": 9,
    "bookshelf": 10,
    "picture": 11,
    "counter": 12,
    "desk": 14,
    "curtain": 16,
    "refrigerator": 24,
    "shower curtain": 28,
    "toilet": 33,
    "sink": 34,
    "bathtub": 36,
    "other furniture": 39,
}

scannet_det_map = {
    "cabinet": 0,
    "bed": 1,
    "chair": 2,
    "sofa": 3,
    "table": 4,
    "door": 5,
    "window": 6,
    "bookshelf": 7,
    "picture": 8,
    "counter": 9,
    "desk": 10,
    "curtain": 11,
    "refrigerator": 12,
    "shower curtain": 13,
    "toilet": 14,
    "sink": 15,
    "bathtub": 16,
    "other furniture": 17,
}

scannet200_class_map = {
    "chair": 2,
    "book": 22,
    "door": 5,
    "object": 1163,
    "window": 16,
    "table": 4,
    "trash can": 56,
    "pillow": 13,
    "picture": 15,
    "box": 26,
    "doorframe": 161,
    "monitor": 19,
    "cabinet": 7,
    "desk": 9,
    "shelf": 8,
    "office chair": 10,
    "towel": 31,
    "couch": 6,
    "sink": 14,
    "backpack": 48,
    "lamp": 28,
    "bed": 11,
    "bookshelf": 18,
    "mirror": 71,
    "curtain": 21,
    "plant": 40,
    "whiteboard": 52,
    "radiator": 96,
    "kitchen cabinet": 29,
    "toilet paper": 49,
    "armchair": 23,
    "shoe": 63,
    "coffee table": 24,
    "toilet": 17,
    "bag": 47,
    "clothes": 32,
    "keyboard": 46,
    "bottle": 65,
    "recycling bin": 97,
    "nightstand": 34,
    "stool": 38,
    "tv": 33,
    "file cabinet": 75,
    "dresser": 36,
    "computer tower": 64,
    "telephone": 101,
    "cup": 130,
    "refrigerator": 27,
    "end table": 44,
    "jacket": 131,
    "shower curtain": 55,
    "bathtub": 42,
    "microwave": 59,
    "kitchen counter": 159,
    "sofa chair": 74,
    "paper towel dispenser": 82,
    "bathroom vanity": 1164,
    "suitcase": 93,
    "laptop": 77,
    "ottoman": 67,
    "shower wall": 128,
    "printer": 50,
    "counter": 35,
    "board": 69,
    "soap dispenser": 100,
    "stove": 62,
    "light": 105,
    "closet wall": 1165,
    "mini fridge": 165,
    "fan": 76,
    "tissue box": 230,
    "blanket": 54,
    "bathroom stall": 125,
    "copier": 72,
    "bench": 68,
    "bar": 145,
    "soap dish": 157,
    "laundry hamper": 1166,
    "storage bin": 132,
    "bathroom stall door": 1167,
    "light switch": 232,
    "coffee maker": 134,
    "tv stand": 51,
    "decoration": 250,
    "ceiling light": 1168,
    "range hood": 342,
    "blackboard": 89,
    "clock": 103,
    "wardrobe": 99,
    "rail": 95,
    "bulletin board": 154,
    "mat": 140,
    "trash bin": 1169,
    "ledge": 193,
    "seat": 116,
    "mouse": 202,
    "basket": 73,
    "shower": 78,
    "dumbbell": 1170,
    "paper": 79,
    "person": 80,
    "windowsill": 141,
    "closet": 57,
    "bucket": 102,
    "sign": 261,
    "speaker": 118,
    "dishwasher": 136,
    "container": 98,
    "stair rail": 1171,
    "shower curtain rod": 170,
    "tube": 1172,
    "bathroom cabinet": 1173,
    "storage container": 221,
    "paper bag": 570,
    "paper towel roll": 138,
    "ball": 168,
    "closet door": 276,
    "laundry basket": 106,
    "cart": 214,
    "dish rack": 323,
    "stairs": 58,
    "blinds": 86,
    "purse": 399,
    "bicycle": 121,
    "tray": 185,
    "plunger": 300,
    "paper cutter": 180,
    "toilet paper dispenser": 163,
    "bin": 66,
    "toilet seat cover dispenser": 208,
    "guitar": 112,
    "mailbox": 540,
    "handicap bar": 395,
    "fire extinguisher": 166,
    "ladder": 122,
    "column": 120,
    "pipe": 107,
    "vacuum cleaner": 283,
    "plate": 88,
    "piano": 90,
    "water cooler": 177,
    "cd case": 1174,
    "bowl": 562,
    "closet rod": 1175,
    "bathroom counter": 1156,
    "oven": 84,
    "stand": 104,
    "scale": 229,
    "washing machine": 70,
    "broom": 325,
    "hat": 169,
    "guitar case": 331,
    "rack": 87,
    "water pitcher": 488,
    "laundry detergent": 776,
    "hair dryer": 370,
    "pillar": 191,
    "divider": 748,
    "power outlet": 242,
    "dining table": 45,
    "shower floor": 417,
    "shower door": 188,
    "coffee kettle": 1176,
    "structure": 1178,
    "clothes dryer": 110,
    "toaster": 148,
    "ironing board": 155,
    "alarm clock": 572,
    "shower head": 1179,
    "water bottle": 392,
    "keyboard piano": 1180,
    "projector screen": 609,
    "case of water bottles": 1181,
    "toaster oven": 195,
    "music stand": 581,
    "coat rack": 1182,
    "storage organizer": 1183,
    "machine": 139,
    "folded chair": 1184,
    "fire alarm": 1185,
    "fireplace": 156,
    "vent": 408,
    "furniture": 213,
    "power strip": 1186,
    "calendar": 1187,
    "poster": 1188,
    "toilet paper holder": 115,
    "potted plant": 1189,
    "stuffed animal": 304,
    "luggage": 1190,
    "headphones": 312,
    "crate": 233,
    "candle": 286,
    "projector": 264,
    "mattress": 1191,
    "dustpan": 356,
    "cushion": 39,
    "stick": 1163,
}

scannet200_det_map = {
    "chair": 0,
    "table": 1,
    "door": 2,
    "couch": 3,
    "cabinet": 4,
    "shelf": 5,
    "desk": 6,
    "office chair": 7,
    "bed": 8,
    "pillow": 9,
    "sink": 10,
    "picture": 11,
    "window": 12,
    "toilet": 13,
    "bookshelf": 14,
    "monitor": 15,
    "curtain": 16,
    "book": 17,
    "armchair": 18,
    "coffee table": 19,
    "box": 20,
    "refrigerator": 21,
    "lamp": 22,
    "kitchen cabinet": 23,
    "towel": 24,
    "clothes": 25,
    "tv": 26,
    "nightstand": 27,
    "counter": 28,
    "dresser": 29,
    "stool": 30,
    "plant": 31,
    "bathtub": 32,
    "end table": 33,
    "dining table": 34,
    "keyboard": 35,
    "bag": 36,
    "backpack": 37,
    "toilet paper": 38,
    "printer": 39,
    "tv stand": 40,
    "whiteboard": 41,
    "blanket": 42,
    "shower curtain": 43,
    "trash can": 44,
    "closet": 45,
    "stairs": 46,
    "microwave": 47,
    "stove": 48,
    "shoe": 49,
    "computer tower": 50,
    "bottle": 51,
    "bin": 52,
    "ottoman": 53,
    "bench": 54,
    "board": 55,
    "washing machine": 56,
    "mirror": 57,
    "copier": 58,
    "basket": 59,
    "sofa chair": 60,
    "file cabinet": 61,
    "fan": 62,
    "laptop": 63,
    "shower": 64,
    "paper": 65,
    "person": 66,
    "paper towel dispenser": 67,
    "oven": 68,
    "blinds": 69,
    "rack": 70,
    "plate": 71,
    "blackboard": 72,
    "piano": 73,
    "suitcase": 74,
    "rail": 75,
    "radiator": 76,
    "recycling bin": 77,
    "container": 78,
    "wardrobe": 79,
    "soap dispenser": 80,
    "telephone": 81,
    "bucket": 82,
    "clock": 83,
    "stand": 84,
    "light": 85,
    "laundry basket": 86,
    "pipe": 87,
    "clothes dryer": 88,
    "guitar": 89,
    "toilet paper holder": 90,
    "seat": 91,
    "speaker": 92,
    "column": 93,
    "ladder": 94,
    "cup": 95,
    "jacket": 96,
    "storage bin": 97,
    "coffee maker": 98,
    "dishwasher": 99,
    "paper towel roll": 100,
    "machine": 101,
    "mat": 102,
    "windowsill": 103,
    "bar": 104,
    "bulletin board": 105,
    "ironing board": 106,
    "fireplace": 107,
    "soap dish": 108,
    "kitchen counter": 109,
    "doorframe": 110,
    "toilet paper dispenser": 111,
    "mini fridge": 112,
    "fire extinguisher": 113,
    "ball": 114,
    "hat": 115,
    "shower curtain rod": 116,
    "water cooler": 117,
    "paper cutter": 118,
    "tray": 119,
    "pillar": 120,
    "ledge": 121,
    "toaster oven": 122,
    "mouse": 123,
    "toilet seat cover dispenser": 124,
    "cart": 125,
    "scale": 126,
    "tissue box": 127,
    "light switch": 128,
    "crate": 129,
    "power outlet": 130,
    "decoration": 131,
    "sign": 132,
    "projector": 133,
    "closet door": 134,
    "vacuum cleaner": 135,
    "headphones": 136,
    "dish rack": 137,
    "broom": 138,
    "range hood": 139,
    "hair dryer": 140,
    "water bottle": 141,
    "vent": 142,
    "mailbox": 143,
    "bowl": 144,
    "paper bag": 145,
    "projector screen": 146,
    "divider": 147,
    "laundry detergent": 148,
    "bathroom counter": 149,
    "stick": 150,
    "bathroom vanity": 151,
    "closet wall": 152,
    "laundry hamper": 153,
    "bathroom stall door": 154,
    "ceiling light": 155,
    "trash bin": 156,
    "dumbbell": 157,
    "stair rail": 158,
    "tube": 159,
    "bathroom cabinet": 160,
    "coffee kettle": 161,
    "shower head": 162,
    "case of water bottles": 163,
    "power strip": 164,
    "calendar": 165,
    "poster": 166,
    "mattress": 167,
}


class ScanNetDataset(COCO3DDataset):
    """ScanNetV2 dataset."""

    def __init__(
        self,
        class_map: dict[str, int] = scannet_class_map,
        max_depth: float = 12.0,
        depth_scale: float = 1000.0,
        **kwargs: ArgsType,
    ) -> None:
        """Creates an instance of the class."""
        super().__init__(
            class_map=class_map,
            max_depth=max_depth,
            depth_scale=depth_scale,
            **kwargs,
        )

    def get_depth_filenames(self, img: DictStrAny) -> str | None:
        """Get the depth filenames.

        Since not every data has depth.
        """
        return (
            img["file_path"].replace("image", "depth").replace(".jpg", ".png")
        )
